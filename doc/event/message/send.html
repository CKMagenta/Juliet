<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>EVENT/MESSAGE:SEND</title>
</head>
<body>
<div>
	<h2>EVENT/MESSAGE:SEND</h2>
</div>
<div>
	<p>
		메세지 전송. 채팅과 DOCUMENT와 SURVEY를 전송할 때 모두 이 이벤트를 활용하고 세부 구분은 서버 쪽에서 한다. 
	</p>
</div>
<div>
	<ul>
		<li>request payload
			<ul>
				<li>event / MESSAGE:SEND</li>
				<li>data
<ul>
	<li>message가 chat일 때
	<pre>
	[ { "message": {
					"sender_hash": 발신자 해쉬,
					"receiver_hash": [ 수신자1, 수신자2, ... ],
					"type": 메세지 타입 숫자,
					"title": 메세지 타이틀,
					"content": 메세지 내용,
					"room_hash": 채팅방 해쉬
					}
		 } ]
	</pre></li>
	<li>message가 document일 때
	<pre>
	[ { "message": {
					"sender_hash": 발신자 해쉬,
					"receiver_hash": [ 수신자1, 수신자2, ... ],
					"type": 메세지 타입 숫자
					"title": 메세지 타이틀
					"content": 메세지 내용,
					"forwards": [ {  "forwarder": 전달자1 , "TS": 전달시간, "content": 전달내용  }, 
									{}, ...  ]
					}
		 } ]
	</pre></li>
	<li>message가 survey일 때
	<pre>
	[ { "message": {
					"sender_hash": 발신자 해쉬,
					"receiver_hash": [ 수신자1, 수신자2, ... ],
					"type": 메세지 타입 숫자
					"title": 메세지 타이틀
					"content": 메세지 내용,
					"openTS": 설문조사 시작시간,
					"closeTS": 설문조사 마감시간,
					"survey_form":
						{
							"questions": 
						}
					}
		 } ]
	</pre></li>

</ul>
				</li>
			</ul>
		</li>
		<li>response payload
			<ul>
				<li>성공 시
					<ul>
						<li>event / MESSAGE:SEND</li>
						<li>status / 1 (SUCCESS)</li>
						<li>data 
<pre>
[ { "sendResultFromGCM" : GCM 서버로부터 받은 response json 객체 (예시)
		{ "multicast_id": 216,
		  "success": 3,
		  "failure": 3,
		  "canonical_ids": 1,
		  "results": [
		    { "message_id": "1:0408" },
		    { "error": "Unavailable" },
		    { "error": "InvalidRegistration" },
		    { "message_id": "1:1516" },
		    { "message_id": "1:2342", "registration_id": "32" },
		    { "error": "NotRegistered"}
		  ]
		},
	"receiver_hash": [수신자해쉬1, 수신자해쉬2, ...]
	"regids": [수신자 regid1, 수신자 regid2, ... ]
	"msg_hash": 메세지 해쉬
} ]
</pre>
						</li>
					</ul>
				</li>
				<li>인수가 부족할 때
					<ul>
					<li>event / MESSAGE:SEND</li>
					<li>status / 2 (INSUFFICIENT_ARGUMENTS)</li>
					<li>data
<pre>
[ {"msg": 에러메세지 } ]
</pre>
					</li>
					</ul>
				</li>
				<li>수신/발신자 해시가 이상할때
					<ul>
					<li>event / MESSAGE:SEND</li>
					<li>status / 3 (NO_DATA)</li>
					<li>data
<pre>
[ {"msg": 에러메세지 } ]
</pre>
					</li>
					</ul>
				</li>
			</ul>
		</li>
		
	</ul>
</div>
</body>
</html>